<!DOCTYPE HTML>
<!DOCTYPE html PUBLIC "" ""><!-- saved from url=(0133)file:///C:/Users/86157/Desktop/%E8%BF%94%E6%A0%A1%E6%A0%B8%E9%AA%8C%20-%20%E5%8D%8E%E5%8D%97%E5%B8%88%E8%8C%83%E5%A4%A7%E5%AD%A6.html --><HTML 
lang="zh-CN"><HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
<META name="renderer" content="webkit"> 
<META http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
<META name="viewport" content="width=device-width, initial-scale=1"> <TITLE>返校核验 
- 华南师范大学</TITLE> <!-- Bootstrap Core CSS --> <LINK href="./返校核验 - 华南师范大学_files/bootstrap.min.css" 
rel="stylesheet" type="text/css"> <!-- App css --> <LINK id="bs-default-stylesheet" 
href="./返校核验 - 华南师范大学_files/bootstrap-creative.min.css" rel="stylesheet" type="text/css"> 
<LINK id="app-default-stylesheet" href="./返校核验 - 华南师范大学_files/app-creative.min.css" 
rel="stylesheet" type="text/css"> <!-- icons --> <LINK href="./返校核验 - 华南师范大学_files/icons.min.css" 
rel="stylesheet" type="text/css"> <!-- custom --> <LINK href="./返校核验 - 华南师范大学_files/customer.css" 
rel="stylesheet" type="text/css"> <!-- favicon --> <LINK href="https://statics.scnu.edu.cn/statics/images/favicon.ico" 
rel="shortcut icon"> 
<STYLE id="__web-inspector-hide-shortcut-style__">
.__web-inspector-hide-shortcut__, .__web-inspector-hide-shortcut__ *, .__web-inspector-hidebefore-shortcut__::before, .__web-inspector-hideafter-shortcut__::after
{
    visibility: hidden !important;
}
</STYLE>
</HEAD> 
<BODY data-sidebar-showuser="false" data-sidebar-color="light" 
data-sidebar-size="default" data-topbar-color="dark" data-layout-menu-position="fixed" 
data-layout-width="fluid" data-layout-mode="horizontal"><!-- Begin page --> 
<DIV id="wrapper"><!-- ============================================================== -->
	 <!-- Start Page Content here -->	 <!-- ============================================================== -->
	 
<DIV class="content-page">
<DIV class="content"><!-- Start Content-->			 
<DIV class="container-fluid operation-area pb-3 pass" id="background">
<DIV class="row">
<DIV class="col-12">
<H4 class="header-title text-center pt-3 pb-0">返校核验结果</H4></DIV>
<DIV class="col-12 mt-3">
<DIV class="card-box inbox-widget inbox-userinfo">
<DIV class="inbox-item">
<DIV class="inbox-item-img"><IMG class="rounded-circle avatar-xl img-thumbnail" 
alt="profile-image" src="./返校核验 - 华南师范大学_files/photo.jpg"></DIV>
<P class="inbox-item-author">姓名：吴丽琳</P>
<P class="inbox-item-author">身份：本科生</P>
<P class="inbox-item-author">学号：20212831025</P>
<P class="inbox-item-author">学院：教育信息技术学院</P></DIV></DIV></DIV></DIV>
<DIV class="row">
<DIV class="col-12">
<DIV class="time text-center">
<H2 id="myTime2">2022年11月19日 18:28:15</H2>
<H3 class="notice" id="msg">请通行</H3></DIV></DIV></DIV>
<UL class="bg-bubbles">
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI>
  <LI><I class="fas fa-arrow-up"></I></LI></UL></DIV>
<DIV class="container code-area">
<DIV class="row mt-3">
<DIV class="col-6 col-apps pass" id="ykm">
<DIV class="card card-body">
<DIV class="text-center">
<P class="code-title">粤康码</P>
<H2 class="code-status" id="ykmmsg">绿码
<P></P><SPAN style="font-size: 32px;">24</SPAN><SPAN 
style="font-size: 20px;">小时阴性</SPAN></H2>
<DIV id="ykmtime">
<P><SMALL class="code-time">核验时间：2022-11-20 19:14:32</SMALL></P></DIV><!--<p><small id="yuekangcode" class="code-time"><a href="###" class="reload mt-1">重新查询</a></small></p>-->
							 </DIV></DIV></DIV>
<DIV class="col-6 col-apps pass" id="apply">
<DIV class="card card-body">
<DIV class="text-center">
<P class="code-title">返校申请</P><!--<h2 class="code-status">无记录</h2>
								<p class="mb-0"><small class="code-time">离校日期：2022-04-30</small></p>
								<p><small id="backtostatus" class="code-time">返校日期：2022-05-04</small></p>-->
								 
<H2 class="code-status" id="applymsg">通过</H2>
<DIV id="applytime">
<P class="mb-0"><SMALL class="code-time">离校日期：2022-11-20</SMALL></P>
<P><SMALL class="code-time" 
id="backtostatus">返校日期：2022-11-20</SMALL></P></DIV></DIV></DIV></DIV>
<DIV class="col-12">
<DIV class="alert alert-info fix">
<DIV class="float-left">请暂时不要关闭此页面，入校时向保安/志愿者展示。</DIV></DIV></DIV></DIV></DIV><!-- container -->
		 </DIV><!-- content -->	 </DIV><!-- ============================================================== -->
	 <!-- End Page content -->	 <!-- ============================================================== --> 
</DIV><!-- END wrapper --> <!-- Vendor js --> 
<SCRIPT src="./返校核验 - 华南师范大学_files/vendor.min.js.下载"></SCRIPT>
 <!-- App js --> 
<SCRIPT src="./返校核验 - 华南师范大学_files/app.min.js.下载"></SCRIPT>
 
<SCRIPT src="./返校核验 - 华南师范大学_files/jquery.min.js.下载"></SCRIPT>
 
<SCRIPT>
	var myTime;
	var hsjgMsg = "<span style=\"font-size: 32px\">24<\/span><span style=\"font-size: 20px\">\u5c0f\u65f6\u9634\u6027<\/span>"
	function showTime2() {
		var time = new Date();
		var y = time.getFullYear();
		var mon = time.getMonth() + 1; //0-11
		var d = time.getDate();
		var h = time.getHours();
		var m = time.getMinutes();
		var s = time.getSeconds();
		var addNumber = function (value) {
			return value > 9 ? value : "0" + value;
		}
		var date = y + "年" + addNumber(mon)+ "月" +addNumber(d)+ "日 " + addNumber(h) + ":" + addNumber(m) + ":" + addNumber(s);
		var date2=y + "-" + addNumber(mon)+ "-" +addNumber(d)+ "- " + addNumber(h) + ":" + addNumber(m) + ":" + addNumber(s);
		$("#myTime2").html(date);
		$("#myTime").html(date2);
		clock2 = window.setTimeout("showTime2()", 1000);/*递归实现定时器*/
	}
	
	//setTimeout只能定时执行唯一一次，可使用递归达到定时器效果
	var clock2 = window.setTimeout("showTime2()", 1000);

	window.setTimeout("showTime2()", 1000);

	var counter = 0;
	var interval= setInterval(check,1000);

	function check() {
		counter++;
		$.ajax({
			url:"/mobile/checkcode/checkResult.html",
			type:'POST',
			data: {},
			dataType: 'json',
			success: function (data) {
				if(data.status == 1){
					$('#background').removeClass('load');
					$('#ykm').removeClass('load');
					$('#apply').removeClass('load');
					clearInterval(interval);

					if(data.data.background == 1){
						background = 'pass';
						msg = '请通行';
					}else if(data.data.background == 2){
						background = 'warning'
						msg = '请通行';
					}else if(data.data.background == 3){
						background = 'error';
						msg = '请通行';
					}else{
						background = 'check';
						if(data.data.ykm == 0 && data.data.back != 0){
							msg = '请通行';
						}else{
							msg = '请通行';
						}
					}
					$('#background').addClass(background);
					$('#msg').html(msg);

					if(data.data.back == 0){
						back = 'check'
						backmsg = '暂无数据';
						startDateMsg = '离校日期';
						endDateMsg = '返校日期';
					}else{
						if(data.data.back == 1){
							backmsg = '走读';
							startDateMsg = '起始日期';
							endDateMsg = '结束日期';
						}else if(data.data.back == 2){
							backmsg = '市内外出';
							startDateMsg = '起始日期';
							endDateMsg = '结束日期';
						}else if(data.data.back == 4){
							backmsg = '假期留校';
							startDateMsg = '起始日期';
							endDateMsg = '结束日期';
						}else if(data.data.back == 5){
							backmsg = '新生进校';
							startDateMsg = '出发日期';
							endDateMsg = '到校日期';
						}else if(data.data.back == 6){
							backmsg = '区内外出';
							startDateMsg = '起始日期';
							endDateMsg = '结束日期';
						}else{
							backmsg = '通过';
							startDateMsg = '离校日期';
							endDateMsg = '返校日期';
						}
						back = 'pass'
					}
					$('#apply').addClass(back);
					$('#applymsg').html(backmsg);
					$('#applytime').empty();
					$('#applytime').append('<p class="mb-0"><small class="code-time">'+startDateMsg+'：'+data.data.qjstart+'</small></p><p><small id="backtostatus" class="code-time">'+endDateMsg+'：'+data.data.qjend+'</small></p>');

					button = '';
					if(data.data.ykm == 0){
						ykm = 'info'
						ykmmsg = '暂无数据'
						button = '<p><small id="yuekangcode" class="code-time"><a href="##" onclick="recheck()" class="reload mt-1">重新查询</a></small></p>';
					}else if(data.data.ykm == 1){
						ykm = 'pass'
						ykmmsg = '绿码'
					}else if(data.data.ykm == 2){
						ykm = 'warning'
						ykmmsg = '黄码'
					}else{
						ykm = 'error'
						ykmmsg = '红码'
					}
					$('#ykm').addClass(ykm);
					$('#ykmmsg').html(ykmmsg+"<p></p>"+hsjgMsg);
					$('#ykmtime').empty();
					$('#ykmtime').append(button+'<p><small class="code-time">核验时间：+myTime+</small></p>');

				}else if(data.status == -1){
					button = '<p><small id="yuekangcode" class="code-time"><a href="##" onclick="recheck()" class="reload mt-1">重新查询</a></small></p>';
					$('#ykmtime').empty();
					$('#ykmtime').append(button);
					clearInterval(interval)
				}
			},
			error:function (msg) {
				console.log(msg)
			}
		});
		if(counter>900000) {
			button = '<p><small id="yuekangcode" class="code-time"><a href="##" onclick="recheck()" class="reload mt-1">重新查询</a></small></p>';
			$('#ykmtime').empty();
			$('#ykmtime').append(button);
			clearInterval(interval);
		}

	}
	
	function recheck() {
		var siteId = "0";
		$.ajax({
			url:"/mobile/checkcode/recheck.html",
			type:'POST',
			data: {site:siteId},
			dataType: 'json',
			success: function (data) {
				if(data.status == 1) {
					$('#ykmtime').empty();
					interval= setInterval(check,1000);
					counter=0;
				}
			},
			error:function (msg) {
				console.log(msg)
			}
		});
	}

</SCRIPT>
 </BODY></HTML>
